#
# $Id: QS_HeaderFilter.txt,v 1.3 2007-10-28 19:23:19 pbuchbinder Exp $
#


INCLUDE scripts/ports

CLIENT
# allowed headers
_REQ localhost $QS_PORT_BASE
__GET /cgi-local/index.cgi HTTP/1.1
__Host: localhost
__Connection: keep-alive
__Accept: text/*;q=0.3, text/html;q=0.7, text/html;level=1, text/html;level=2;q=0.4, */*;q=0.5
__Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
__Accept-Encoding: gzip,deflate
__ACCEPT-LANGUAGE: en-us,en;q=0.5
__CACHE-CONTROL: max-age=0
__MAX-forwards: 10
__User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.5) Gecko/20070713 Firefox/2.0.0.5
__X-FORWARDED-FOR: 127.0.0.1
__X-FORWARDED-HOST: localhost:5960
__X-FORWARDED-SERVER: 127.0.0.1
__
_EXPECT . "200 OK"
_EXPECT . "HTTP_ACCEPT"
_EXPECT . "HTTP_ACCEPT_CHARSET"
_EXPECT . "HTTP_ACCEPT_ENCODING"
_EXPECT . "HTTP_ACCEPT_LANGUAGE"
_EXPECT . "HTTP_CACHE_CONTROL"
_EXPECT . "HTTP_CONNECTION"
_EXPECT . "HTTP_HOST"
_EXPECT . "HTTP_MAX_FORWARDS"
_EXPECT . "HTTP_USER_AGENT"
_EXPECT . "HTTP_X_FORWARDED_FOR"
_EXPECT . "HTTP_X_FORWARDED_HOST"
_EXPECT . "HTTP_X_FORWARDED_SERVER"
_WAIT

# drop headers
_REQ localhost $QS_PORT_BASE
__GET /cgi-local/index.cgi HTTP/1.1
__Host: localhost
__Connection: keep-alive
__Accept: text/*;q=0.3, text/html;q=0.7, text/html;level=1, text/@html;level=2;q=0.4, */*;q=0.5
__Other: text
__
_EXPECT . "200 OK"
_EXPECT . "!HTTP_ACCEPT"
_EXPECT . "!HTTP_OTHER"
_WAIT

END
